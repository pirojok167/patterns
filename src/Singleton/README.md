# Одиночка

### Суть паттерна
Singleton паттерн необходим для создания уникальных объектов в единственном экземпляре.
Создание уникальных объектов может понадобиться для подключения к базе, кеширования и т.д.
Одно из главных преимуществ таких объектов в том, что мы можем их создавать в любом месте когда нам понадобится,
при этом только один раз.

### Реализация

С помощью оператора `new` мы можем создавать неограниченное кол-во объектов одного и того же класса, 
как нам это предотвратить? Сделаем конструктор класса приватным:
```java
class Singleton {
    private Singleton() {}
}
```

Теперь наш конструктор приватный, и мы не может создавать объекты этого класса снаружи с помощью оператора `new`.
Давайте добавим статический публичный метод, создающий инстанс этого класса:

```java
class Singleton {
    public static Singleton getInstance() {
        return new Singleton();
    }
}
```

### Singleton в многопоточных программах

Если в двух потоках использовать один и тот же singleton класс, то у нас будет два инстанса, вместо одного.

Существуют разные решения этой проблемы:

1. Добавить `synchronized` к методу, то есть синхронизировать потоки. В таком случае будет тратиться больше ресурсов, но если это не критично, то можно использовать.
2. Инициализировать объект до запуска приложения. В таком случае иногда объект будет просто висеть мертвым грузом, но это тоже чаще всего не критично.
3. Воспользоваться условной блокировкой. Добавить `volatile` к методу, и вызывать синхронизацию только при первом вызове инстанса.