# Команда

## Суть
Паттерн позволяет отделить клиента (например view в MVC) и получателя (model в MVC),
посредством оборачивания вызова в специальный объект - команду. 
Таким образом клиент и получатель полностью отвязаны друг от друга.
Этот паттерн очень похож на `Observer`.

## Пример
### Пример из жизни
Классический пример из жизни, который приводят во многих источниках:
Официантка записывает заказ клиента на листочек и передаёт его повару.
Официантка-команда, условно говоря, ничего не знает о самом заказе. 
Она просто передала листочек получателю-повару.

### Практический пример

У нас есть [умная станция](SmartStation.java) с кнопками и голосовым управлением.
Эта станция является *клиентом*. При нажатии на кнопку или голосовом управлении,
у нас вызывается какая-то команда, например [включение света](LightOnCommand.java),
внутри которой завернут запрос. Эта команда передаётся [получателю](RemoteControl.java) который,
вызывает завёрнутый запрос.

Чтобы абстрагироваться от вызова какого-то конкретного класса, мы добавляем [интерфейс](Command.java) для команд.
Каждая команда будет иметь всего один метод `execute`, который и будет вызывать получатель.

### Улучшения команды
На самом деле классы вовсе не нужны для передачи запроса. Мы можем передавать вместо классов - лямбда выражения.
```java
class SmartStation {
    RemoteControl remoteControl = new RemoteControl();
    Light kitchenLighting = new Light("Kitchen");

    remoteControl.setCommand(() -> kitchenLighting.on());
}
```
В так случае мы можем избавиться от лишних классов.
Получатель всё так же принимает интерфейс, поэтому если в него мы добавим больше одного метода, то это работать не будет.
На самом деле лямбда это те же объекты, которые имею всего лишь один метод.

Ещё иногда мы можем упростить паттерн, перенеся логику из получателя сразу в команду.

### Расширяем команду
#### Отмена
 Паттерн довольно гибкий и позволяет делать такие вещи, например, как операция отмены.
 Для этого нужно добавить ещё один метод `undo` в [интерфейс команды](Command.java).
 Таким образом каждая команда будет поддерживать метод отмены. [Пример команды с отменой](LightOnCommand.java).
 
#### Сохранение и восстановление
Мы можем добавить в команду такие методы, как `store` запись в журнал и `load` - чтение из журнала.
Если мы будем сохранять наши действия в журнал, то при краше мы можем легко восстановиться,
просто читав данные не из клиента, а из журнала.

#### Очередь команд
Паттерн позволяет добавлять команды в [очередь](HomeCommand.java). Мы создаём команду с тем же интерфейсом [Command](Command.java).
Затем наполняем эту команду другими командами, и в методе `execute` в цикле вызываем все команды.
